import N from"node:fs";import V from"node:path";import _ from"node:process";import{fileURLToPath as XQ}from"node:url";import{normalizePath as UQ}from"vite";import o from"node:path";import i from"node:process";import{parse as r,traverse as t}from"@babel/core";import n from"@babel/plugin-proposal-decorators";import e from"@babel/plugin-syntax-import-attributes";import QQ from"@babel/plugin-syntax-import-meta";import ZQ from"@babel/plugin-transform-typescript";var k=44,m=59,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=new Uint8Array(64),g=new Uint8Array(128);for(let Q=0;Q<O.length;Q++){let Z=O.charCodeAt(Q);T[Q]=Z,g[Z]=Q}function z(Q,Z,J){let K=Z-J;K=K<0?-K<<1|1:K<<1;do{let Y=K&31;if(K>>>=5,K>0)Y|=32;Q.write(T[Y])}while(K>0);return Z}var P=16384,R=typeof TextDecoder!=="undefined"?new TextDecoder:typeof Buffer!=="undefined"?{decode(Q){return Buffer.from(Q.buffer,Q.byteOffset,Q.byteLength).toString()}}:{decode(Q){let Z="";for(let J=0;J<Q.length;J++)Z+=String.fromCharCode(Q[J]);return Z}},p=class{constructor(){this.pos=0,this.out="",this.buffer=new Uint8Array(P)}write(Q){let{buffer:Z}=this;if(Z[this.pos++]=Q,this.pos===P)this.out+=R.decode(Z),this.pos=0}flush(){let{buffer:Q,out:Z,pos:J}=this;return J>0?Z+R.decode(Q.subarray(0,J)):Z}};function v(Q){let Z=new p,J=0,K=0,Y=0,H=0;for(let G=0;G<Q.length;G++){let $=Q[G];if(G>0)Z.write(m);if($.length===0)continue;let W=0;for(let X=0;X<$.length;X++){let U=$[X];if(X>0)Z.write(k);if(W=z(Z,U[0],W),U.length===1)continue;if(J=z(Z,U[1],J),K=z(Z,U[2],K),Y=z(Z,U[3],Y),U.length===4)continue;H=z(Z,U[4],H)}}return Z.flush()}class F{constructor(Q){this.bits=Q instanceof F?Q.bits.slice():[]}add(Q){this.bits[Q>>5]|=1<<(Q&31)}has(Q){return!!(this.bits[Q>>5]&1<<(Q&31))}}class j{constructor(Q,Z,J){this.start=Q,this.end=Z,this.original=J,this.intro="",this.outro="",this.content=J,this.storeName=!1,this.edited=!1,this.previous=null,this.next=null}appendLeft(Q){this.outro+=Q}appendRight(Q){this.intro=this.intro+Q}clone(){let Q=new j(this.start,this.end,this.original);return Q.intro=this.intro,Q.outro=this.outro,Q.content=this.content,Q.storeName=this.storeName,Q.edited=this.edited,Q}contains(Q){return this.start<Q&&Q<this.end}eachNext(Q){let Z=this;while(Z)Q(Z),Z=Z.next}eachPrevious(Q){let Z=this;while(Z)Q(Z),Z=Z.previous}edit(Q,Z,J){if(this.content=Q,!J)this.intro="",this.outro="";return this.storeName=Z,this.edited=!0,this}prependLeft(Q){this.outro=Q+this.outro}prependRight(Q){this.intro=Q+this.intro}reset(){if(this.intro="",this.outro="",this.edited)this.content=this.original,this.storeName=!1,this.edited=!1}split(Q){let Z=Q-this.start,J=this.original.slice(0,Z),K=this.original.slice(Z);this.original=J;let Y=new j(Q,this.end,K);if(Y.outro=this.outro,this.outro="",this.end=Q,this.edited)Y.edit("",!1),this.content="";else this.content=J;if(Y.next=this.next,Y.next)Y.next.previous=Y;return Y.previous=this,this.next=Y,Y}toString(){return this.intro+this.content+this.outro}trimEnd(Q){if(this.outro=this.outro.replace(Q,""),this.outro.length)return!0;let Z=this.content.replace(Q,"");if(Z.length){if(Z!==this.content){if(this.split(this.start+Z.length).edit("",void 0,!0),this.edited)this.edit(Z,this.storeName,!0)}return!0}else if(this.edit("",void 0,!0),this.intro=this.intro.replace(Q,""),this.intro.length)return!0}trimStart(Q){if(this.intro=this.intro.replace(Q,""),this.intro.length)return!0;let Z=this.content.replace(Q,"");if(Z.length){if(Z!==this.content){let J=this.split(this.end-Z.length);if(this.edited)J.edit(Z,this.storeName,!0);this.edit("",void 0,!0)}return!0}else if(this.edit("",void 0,!0),this.outro=this.outro.replace(Q,""),this.outro.length)return!0}}function l(){if(typeof globalThis!=="undefined"&&typeof globalThis.btoa==="function")return(Q)=>globalThis.btoa(unescape(encodeURIComponent(Q)));else if(typeof Buffer==="function")return(Q)=>Buffer.from(Q,"utf-8").toString("base64");else return()=>{throw new Error("Unsupported environment: `window.btoa` or `Buffer` should be supported.")}}var h=l();class b{constructor(Q){if(this.version=3,this.file=Q.file,this.sources=Q.sources,this.sourcesContent=Q.sourcesContent,this.names=Q.names,this.mappings=v(Q.mappings),typeof Q.x_google_ignoreList!=="undefined")this.x_google_ignoreList=Q.x_google_ignoreList;if(typeof Q.debugId!=="undefined")this.debugId=Q.debugId}toString(){return JSON.stringify(this)}toUrl(){return"data:application/json;charset=utf-8;base64,"+h(this.toString())}}function u(Q){let Z=Q.split(`
`),J=Z.filter((H)=>/^\t+/.test(H)),K=Z.filter((H)=>/^ {2,}/.test(H));if(J.length===0&&K.length===0)return null;if(J.length>=K.length)return"\t";let Y=K.reduce((H,G)=>{let $=/^ +/.exec(G)[0].length;return Math.min($,H)},1/0);return new Array(Y+1).join(" ")}function d(Q,Z){let J=Q.split(/[/\\]/),K=Z.split(/[/\\]/);J.pop();while(J[0]===K[0])J.shift(),K.shift();if(J.length){let Y=J.length;while(Y--)J[Y]=".."}return J.concat(K).join("/")}var a=Object.prototype.toString;function c(Q){return a.call(Q)==="[object Object]"}function y(Q){let Z=Q.split(`
`),J=[];for(let K=0,Y=0;K<Z.length;K++)J.push(Y),Y+=Z[K].length+1;return function K(Y){let H=0,G=J.length;while(H<G){let X=H+G>>1;if(Y<J[X])G=X;else H=X+1}let $=H-1,W=Y-J[$];return{line:$,column:W}}}var s=/\w/;class L{constructor(Q){this.hires=Q,this.generatedCodeLine=0,this.generatedCodeColumn=0,this.raw=[],this.rawSegments=this.raw[this.generatedCodeLine]=[],this.pending=null}addEdit(Q,Z,J,K){if(Z.length){let Y=Z.length-1,H=Z.indexOf(`
`,0),G=-1;while(H>=0&&Y>H){let W=[this.generatedCodeColumn,Q,J.line,J.column];if(K>=0)W.push(K);this.rawSegments.push(W),this.generatedCodeLine+=1,this.raw[this.generatedCodeLine]=this.rawSegments=[],this.generatedCodeColumn=0,G=H,H=Z.indexOf(`
`,H+1)}let $=[this.generatedCodeColumn,Q,J.line,J.column];if(K>=0)$.push(K);this.rawSegments.push($),this.advance(Z.slice(G+1))}else if(this.pending)this.rawSegments.push(this.pending),this.advance(Z);this.pending=null}addUneditedChunk(Q,Z,J,K,Y){let H=Z.start,G=!0,$=!1;while(H<Z.end){if(J[H]===`
`)K.line+=1,K.column=0,this.generatedCodeLine+=1,this.raw[this.generatedCodeLine]=this.rawSegments=[],this.generatedCodeColumn=0,G=!0,$=!1;else{if(this.hires||G||Y.has(H)){let W=[this.generatedCodeColumn,Q,K.line,K.column];if(this.hires==="boundary")if(s.test(J[H])){if(!$)this.rawSegments.push(W),$=!0}else this.rawSegments.push(W),$=!1;else this.rawSegments.push(W)}K.column+=1,this.generatedCodeColumn+=1,G=!1}H+=1}this.pending=null}advance(Q){if(!Q)return;let Z=Q.split(`
`);if(Z.length>1){for(let J=0;J<Z.length-1;J++)this.generatedCodeLine++,this.raw[this.generatedCodeLine]=this.rawSegments=[];this.generatedCodeColumn=0}this.generatedCodeColumn+=Z[Z.length-1].length}}var A=`
`,D={insertLeft:!1,insertRight:!1,storeName:!1};class B{constructor(Q,Z={}){let J=new j(0,Q.length,Q);Object.defineProperties(this,{original:{writable:!0,value:Q},outro:{writable:!0,value:""},intro:{writable:!0,value:""},firstChunk:{writable:!0,value:J},lastChunk:{writable:!0,value:J},lastSearchedChunk:{writable:!0,value:J},byStart:{writable:!0,value:{}},byEnd:{writable:!0,value:{}},filename:{writable:!0,value:Z.filename},indentExclusionRanges:{writable:!0,value:Z.indentExclusionRanges},sourcemapLocations:{writable:!0,value:new F},storedNames:{writable:!0,value:{}},indentStr:{writable:!0,value:void 0},ignoreList:{writable:!0,value:Z.ignoreList},offset:{writable:!0,value:Z.offset||0}}),this.byStart[0]=J,this.byEnd[Q.length]=J}addSourcemapLocation(Q){this.sourcemapLocations.add(Q)}append(Q){if(typeof Q!=="string")throw new TypeError("outro content must be a string");return this.outro+=Q,this}appendLeft(Q,Z){if(Q=Q+this.offset,typeof Z!=="string")throw new TypeError("inserted content must be a string");this._split(Q);let J=this.byEnd[Q];if(J)J.appendLeft(Z);else this.intro+=Z;return this}appendRight(Q,Z){if(Q=Q+this.offset,typeof Z!=="string")throw new TypeError("inserted content must be a string");this._split(Q);let J=this.byStart[Q];if(J)J.appendRight(Z);else this.outro+=Z;return this}clone(){let Q=new B(this.original,{filename:this.filename,offset:this.offset}),Z=this.firstChunk,J=Q.firstChunk=Q.lastSearchedChunk=Z.clone();while(Z){Q.byStart[J.start]=J,Q.byEnd[J.end]=J;let K=Z.next,Y=K&&K.clone();if(Y)J.next=Y,Y.previous=J,J=Y;Z=K}if(Q.lastChunk=J,this.indentExclusionRanges)Q.indentExclusionRanges=this.indentExclusionRanges.slice();return Q.sourcemapLocations=new F(this.sourcemapLocations),Q.intro=this.intro,Q.outro=this.outro,Q}generateDecodedMap(Q){Q=Q||{};let Z=0,J=Object.keys(this.storedNames),K=new L(Q.hires),Y=y(this.original);if(this.intro)K.advance(this.intro);return this.firstChunk.eachNext((H)=>{let G=Y(H.start);if(H.intro.length)K.advance(H.intro);if(H.edited)K.addEdit(Z,H.content,G,H.storeName?J.indexOf(H.original):-1);else K.addUneditedChunk(Z,H,this.original,G,this.sourcemapLocations);if(H.outro.length)K.advance(H.outro)}),{file:Q.file?Q.file.split(/[/\\]/).pop():void 0,sources:[Q.source?d(Q.file||"",Q.source):Q.file||""],sourcesContent:Q.includeContent?[this.original]:void 0,names:J,mappings:K.raw,x_google_ignoreList:this.ignoreList?[Z]:void 0}}generateMap(Q){return new b(this.generateDecodedMap(Q))}_ensureindentStr(){if(this.indentStr===void 0)this.indentStr=u(this.original)}_getRawIndentString(){return this._ensureindentStr(),this.indentStr}getIndentString(){return this._ensureindentStr(),this.indentStr===null?"\t":this.indentStr}indent(Q,Z){let J=/^[^\r\n]/gm;if(c(Q))Z=Q,Q=void 0;if(Q===void 0)this._ensureindentStr(),Q=this.indentStr||"\t";if(Q==="")return this;Z=Z||{};let K={};if(Z.exclude)(typeof Z.exclude[0]==="number"?[Z.exclude]:Z.exclude).forEach((X)=>{for(let U=X[0];U<X[1];U+=1)K[U]=!0});let Y=Z.indentStart!==!1,H=(W)=>{if(Y)return`${Q}${W}`;return Y=!0,W};this.intro=this.intro.replace(J,H);let G=0,$=this.firstChunk;while($){let W=$.end;if($.edited){if(!K[G]){if($.content=$.content.replace(J,H),$.content.length)Y=$.content[$.content.length-1]===`
`}}else{G=$.start;while(G<W){if(!K[G]){let X=this.original[G];if(X===`
`)Y=!0;else if(X!=="\r"&&Y)if(Y=!1,G===$.start)$.prependRight(Q);else this._splitChunk($,G),$=$.next,$.prependRight(Q)}G+=1}}G=$.end,$=$.next}return this.outro=this.outro.replace(J,H),this}insert(){throw new Error("magicString.insert(...) is deprecated. Use prependRight(...) or appendLeft(...)")}insertLeft(Q,Z){if(!D.insertLeft)console.warn("magicString.insertLeft(...) is deprecated. Use magicString.appendLeft(...) instead"),D.insertLeft=!0;return this.appendLeft(Q,Z)}insertRight(Q,Z){if(!D.insertRight)console.warn("magicString.insertRight(...) is deprecated. Use magicString.prependRight(...) instead"),D.insertRight=!0;return this.prependRight(Q,Z)}move(Q,Z,J){if(Q=Q+this.offset,Z=Z+this.offset,J=J+this.offset,J>=Q&&J<=Z)throw new Error("Cannot move a selection inside itself");this._split(Q),this._split(Z),this._split(J);let K=this.byStart[Q],Y=this.byEnd[Z],H=K.previous,G=Y.next,$=this.byStart[J];if(!$&&Y===this.lastChunk)return this;let W=$?$.previous:this.lastChunk;if(H)H.next=G;if(G)G.previous=H;if(W)W.next=K;if($)$.previous=Y;if(!K.previous)this.firstChunk=Y.next;if(!Y.next)this.lastChunk=K.previous,this.lastChunk.next=null;if(K.previous=W,Y.next=$||null,!W)this.firstChunk=K;if(!$)this.lastChunk=Y;return this}overwrite(Q,Z,J,K){return K=K||{},this.update(Q,Z,J,{...K,overwrite:!K.contentOnly})}update(Q,Z,J,K){if(Q=Q+this.offset,Z=Z+this.offset,typeof J!=="string")throw new TypeError("replacement content must be a string");if(this.original.length!==0){while(Q<0)Q+=this.original.length;while(Z<0)Z+=this.original.length}if(Z>this.original.length)throw new Error("end is out of bounds");if(Q===Z)throw new Error("Cannot overwrite a zero-length range – use appendLeft or prependRight instead");if(this._split(Q),this._split(Z),K===!0){if(!D.storeName)console.warn("The final argument to magicString.overwrite(...) should be an options object. See https://github.com/rich-harris/magic-string"),D.storeName=!0;K={storeName:!0}}let Y=K!==void 0?K.storeName:!1,H=K!==void 0?K.overwrite:!1;if(Y){let W=this.original.slice(Q,Z);Object.defineProperty(this.storedNames,W,{writable:!0,value:!0,enumerable:!0})}let G=this.byStart[Q],$=this.byEnd[Z];if(G){let W=G;while(W!==$){if(W.next!==this.byStart[W.end])throw new Error("Cannot overwrite across a split point");W=W.next,W.edit("",!1)}G.edit(J,Y,!H)}else{let W=new j(Q,Z,"").edit(J,Y);$.next=W,W.previous=$}return this}prepend(Q){if(typeof Q!=="string")throw new TypeError("outro content must be a string");return this.intro=Q+this.intro,this}prependLeft(Q,Z){if(Q=Q+this.offset,typeof Z!=="string")throw new TypeError("inserted content must be a string");this._split(Q);let J=this.byEnd[Q];if(J)J.prependLeft(Z);else this.intro=Z+this.intro;return this}prependRight(Q,Z){if(Q=Q+this.offset,typeof Z!=="string")throw new TypeError("inserted content must be a string");this._split(Q);let J=this.byStart[Q];if(J)J.prependRight(Z);else this.outro=Z+this.outro;return this}remove(Q,Z){if(Q=Q+this.offset,Z=Z+this.offset,this.original.length!==0){while(Q<0)Q+=this.original.length;while(Z<0)Z+=this.original.length}if(Q===Z)return this;if(Q<0||Z>this.original.length)throw new Error("Character is out of bounds");if(Q>Z)throw new Error("end must be greater than start");this._split(Q),this._split(Z);let J=this.byStart[Q];while(J)J.intro="",J.outro="",J.edit(""),J=Z>J.end?this.byStart[J.end]:null;return this}reset(Q,Z){if(Q=Q+this.offset,Z=Z+this.offset,this.original.length!==0){while(Q<0)Q+=this.original.length;while(Z<0)Z+=this.original.length}if(Q===Z)return this;if(Q<0||Z>this.original.length)throw new Error("Character is out of bounds");if(Q>Z)throw new Error("end must be greater than start");this._split(Q),this._split(Z);let J=this.byStart[Q];while(J)J.reset(),J=Z>J.end?this.byStart[J.end]:null;return this}lastChar(){if(this.outro.length)return this.outro[this.outro.length-1];let Q=this.lastChunk;do{if(Q.outro.length)return Q.outro[Q.outro.length-1];if(Q.content.length)return Q.content[Q.content.length-1];if(Q.intro.length)return Q.intro[Q.intro.length-1]}while(Q=Q.previous);if(this.intro.length)return this.intro[this.intro.length-1];return""}lastLine(){let Q=this.outro.lastIndexOf(A);if(Q!==-1)return this.outro.substr(Q+1);let Z=this.outro,J=this.lastChunk;do{if(J.outro.length>0){if(Q=J.outro.lastIndexOf(A),Q!==-1)return J.outro.substr(Q+1)+Z;Z=J.outro+Z}if(J.content.length>0){if(Q=J.content.lastIndexOf(A),Q!==-1)return J.content.substr(Q+1)+Z;Z=J.content+Z}if(J.intro.length>0){if(Q=J.intro.lastIndexOf(A),Q!==-1)return J.intro.substr(Q+1)+Z;Z=J.intro+Z}}while(J=J.previous);if(Q=this.intro.lastIndexOf(A),Q!==-1)return this.intro.substr(Q+1)+Z;return this.intro+Z}slice(Q=0,Z=this.original.length-this.offset){if(Q=Q+this.offset,Z=Z+this.offset,this.original.length!==0){while(Q<0)Q+=this.original.length;while(Z<0)Z+=this.original.length}let J="",K=this.firstChunk;while(K&&(K.start>Q||K.end<=Q)){if(K.start<Z&&K.end>=Z)return J;K=K.next}if(K&&K.edited&&K.start!==Q)throw new Error(`Cannot use replaced character ${Q} as slice start anchor.`);let Y=K;while(K){if(K.intro&&(Y!==K||K.start===Q))J+=K.intro;let H=K.start<Z&&K.end>=Z;if(H&&K.edited&&K.end!==Z)throw new Error(`Cannot use replaced character ${Z} as slice end anchor.`);let G=Y===K?Q-K.start:0,$=H?K.content.length+Z-K.end:K.content.length;if(J+=K.content.slice(G,$),K.outro&&(!H||K.end===Z))J+=K.outro;if(H)break;K=K.next}return J}snip(Q,Z){let J=this.clone();return J.remove(0,Q),J.remove(Z,J.original.length),J}_split(Q){if(this.byStart[Q]||this.byEnd[Q])return;let Z=this.lastSearchedChunk,J=Z,K=Q>Z.end;while(Z){if(Z.contains(Q))return this._splitChunk(Z,Q);if(Z=K?this.byStart[Z.end]:this.byEnd[Z.start],Z===J)return;J=Z}}_splitChunk(Q,Z){if(Q.edited&&Q.content.length){let K=y(this.original)(Z);throw new Error(`Cannot split a chunk that has already been edited (${K.line}:${K.column} – "${Q.original}")`)}let J=Q.split(Z);if(this.byEnd[Z]=Q,this.byStart[Z]=J,this.byEnd[J.end]=J,Q===this.lastChunk)this.lastChunk=J;return this.lastSearchedChunk=Q,!0}toString(){let Q=this.intro,Z=this.firstChunk;while(Z)Q+=Z.toString(),Z=Z.next;return Q+this.outro}isEmpty(){let Q=this.firstChunk;do if(Q.intro.length&&Q.intro.trim()||Q.content.length&&Q.content.trim()||Q.outro.length&&Q.outro.trim())return!1;while(Q=Q.next);return!0}length(){let Q=this.firstChunk,Z=0;do Z+=Q.intro.length+Q.content.length+Q.outro.length;while(Q=Q.next);return Z}trimLines(){return this.trim("[\\r\\n]")}trim(Q){return this.trimStart(Q).trimEnd(Q)}trimEndAborted(Q){let Z=new RegExp((Q||"\\s")+"+$");if(this.outro=this.outro.replace(Z,""),this.outro.length)return!0;let J=this.lastChunk;do{let K=J.end,Y=J.trimEnd(Z);if(J.end!==K){if(this.lastChunk===J)this.lastChunk=J.next;this.byEnd[J.end]=J,this.byStart[J.next.start]=J.next,this.byEnd[J.next.end]=J.next}if(Y)return!0;J=J.previous}while(J);return!1}trimEnd(Q){return this.trimEndAborted(Q),this}trimStartAborted(Q){let Z=new RegExp("^"+(Q||"\\s")+"+");if(this.intro=this.intro.replace(Z,""),this.intro.length)return!0;let J=this.firstChunk;do{let K=J.end,Y=J.trimStart(Z);if(J.end!==K){if(J===this.lastChunk)this.lastChunk=J.next;this.byEnd[J.end]=J,this.byStart[J.next.start]=J.next,this.byEnd[J.next.end]=J.next}if(Y)return!0;J=J.next}while(J);return!1}trimStart(Q){return this.trimStartAborted(Q),this}hasChanged(){return this.original!==this.toString()}_replaceRegexp(Q,Z){function J(Y,H){if(typeof Z==="string")return Z.replace(/\$(\$|&|\d+)/g,(G,$)=>{if($==="$")return"$";if($==="&")return Y[0];if(+$<Y.length)return Y[+$];return`$${$}`});else return Z(...Y,Y.index,H,Y.groups)}function K(Y,H){let G,$=[];while(G=Y.exec(H))$.push(G);return $}if(Q.global)K(Q,this.original).forEach((H)=>{if(H.index!=null){let G=J(H,this.original);if(G!==H[0])this.overwrite(H.index,H.index+H[0].length,G)}});else{let Y=this.original.match(Q);if(Y&&Y.index!=null){let H=J(Y,this.original);if(H!==Y[0])this.overwrite(Y.index,Y.index+Y[0].length,H)}}return this}_replaceString(Q,Z){let{original:J}=this,K=J.indexOf(Q);if(K!==-1)this.overwrite(K,K+Q.length,Z);return this}replace(Q,Z){if(typeof Q==="string")return this._replaceString(Q,Z);return this._replaceRegexp(Q,Z)}_replaceAllString(Q,Z){let{original:J}=this,K=Q.length;for(let Y=J.indexOf(Q);Y!==-1;Y=J.indexOf(Q,Y+K))if(J.slice(Y,Y+K)!==Z)this.overwrite(Y,Y+K,Z);return this}replaceAll(Q,Z){if(typeof Q==="string")return this._replaceAllString(Q,Z);if(!Q.global)throw new TypeError("MagicString.prototype.replaceAll called with a non-global RegExp argument");return this._replaceRegexp(Q,Z)}}import{normalizePath as JQ}from"vite";var KQ=["script","style"],YQ="data-react-inspector";async function w({code:Q,id:Z}){let J=new B(Q),K=JQ(o.relative(i.cwd(),Z)),Y=YQ;return await new Promise((G)=>{let W=r(Q,{babelrc:!1,configFile:!1,comments:!0,plugins:[QQ,[ZQ,{isTSX:!0,allowExtensions:!0}],[n,{legacy:!0}],[e,{deprecatedAssertSyntax:!0}]]});t(W,{enter({node:X}){if(X.type==="JSXElement"&&!KQ.includes(J.slice(X.openingElement.name.start,X.openingElement.name.end))){if(X.openingElement.attributes.some((M)=>M.type!=="JSXSpreadAttribute"&&M.name.name===Y))return;let U=X.openingElement.end-(X.openingElement.selfClosing?2:1),{line:f,column:I}=X.loc.start,x=` ${Y}="${K}:${f}:${I}"`;J.prependLeft(U,x)}}}),G(J.toString())})}import HQ from"node:process";function E(Q){let[Z]=Q.split("?",2),J=new URL(Q,"http://domain.inspector"),K=Object.fromEntries(J.searchParams.entries());if(K.vue!=null)K.vue=!0;if(K.src!=null)K.src=!0;if(K.index!=null)K.index=Number(K.index);if(K.raw!=null)K.raw=!0;if("lang.tsx"in K||"lang.jsx"in K)K.isJsx=!0;return{filename:Z,query:K}}var q="/@fs/",$Q=HQ.platform==="win32",GQ=/\?.*$/s,WQ=/#.*$/s;function S(Q){let Z=Q;if(Z.startsWith(q))Z=Z.slice($Q?q.length:q.length-1);return Z.replace(WQ,"").replace(GQ,"")}function DQ(){return UQ(V.dirname(XQ(import.meta.url))).replace(/\/dist$/,"/src")}function zQ(Q,Z){return`export default ${JSON.stringify({...Q,base:Z.base})}`}function AQ(Q){if(Q.endsWith("/load.js"))return Q.replace("/load.js","/load-react.js");return Q}async function jQ(Q){if(Q.endsWith("/Overlay.jsx")){let Z=V.join(V.dirname(Q),"../dist/overlay.bundle.js");if(N.existsSync(Z))return await N.promises.readFile(Z,"utf-8")}return null}async function FQ(Q){let{query:Z}=E(Q);if(Z.type)return;let J=S(Q);J=AQ(J);let K=await jQ(J);if(K)return K;if(N.existsSync(J))return await N.promises.readFile(J,"utf-8");throw new Error(`Inspector: File not found: ${J}`)}var C={enabled:!1,toggleComboKey:_.platform==="darwin"?"meta-shift":"control-shift",toggleButtonVisibility:"active",toggleButtonPos:"top-right",appendTo:"",lazyLoad:!1,launchEditor:_.env.LAUNCH_EDITOR??"code",reduceMotion:!1};function BQ(Q=C){let Z=DQ(),J={...C,...Q},K,{appendTo:Y}=J;if(J.launchEditor)_.env.LAUNCH_EDITOR=J.launchEditor;return[{name:"vite-plugin-react-inspect",enforce:"pre",apply(H,{command:G}){return G==="serve"&&_.env.NODE_ENV!=="test"},async resolveId(H){if(H.startsWith("virtual:react-inspector-options"))return H;if(H.startsWith("virtual:react-inspector-path:"))return H.replace("virtual:react-inspector-path:",`${Z}/`)},async load(H){if(H==="virtual:react-inspector-options")return zQ(J,K);if(H.startsWith(Z))return await FQ(H)},async transform(H,G){let{filename:$}=E(G);if($.endsWith(".jsx")||$.endsWith(".tsx")||$.endsWith(".js")&&H.includes("jsx")||$.endsWith(".ts")&&H.includes("jsx"))return{code:await w({code:H,id:$,type:"jsx",framework:"react"})};if(!Y)return;let X="virtual:react-inspector-path:load.js";if(typeof Y==="string"&&$.endsWith(Y)||Y instanceof RegExp&&Y.test($))return{code:`${H}
import '${X}'`}},configureServer(H){let G=H.printUrls,{toggleComboKey:$}=J;if($)H.printUrls=()=>{G()}},transformIndexHtml(H){if(Y)return;let G="virtual:react-inspector-path:load.js";return{html:H,tags:[{tag:"script",injectTo:"head",attrs:{type:"module",src:`${K.base||"/"}@id/${G}`}}]}},configResolved(H){K=H}}]}var uQ=BQ;export{uQ as default,C as DEFAULT_INSPECTOR_OPTIONS};
